=======================================
sar宽带限制测试
=======================================

蛟龙网络策略是保障2M带宽，最大10带宽。

但是我们要测试一下。

https://www.2cto.com/kf/201611/568876.html

env
=======================================

::

    A侧主机： 阿里云
    B侧主机： 蛟龙  



step
=======================================


主要思路：用阿里云主机作带宽测试，A侧的接收速率rxkB/s应该约等于B侧出带宽的限制；

B侧主机 提供一个大文件供下载
---------------------------------------


A侧主机：terminal 1，模拟用户不断发送请求
---------------------------------------

负责下载

for((i=0;i<10;i++)); do (curl B侧IP/CentOS-7-x86_64-DVD-1511.iso > /dev/null 2>&1 &); done（模拟用户不断发送请求）

::

    [tom@jlch_web_001 ~]$ curl http://api-cm.zhangtl.com:8000/draft/CentOS-7-x86_64-Minimal-1611.iso


A侧主机：terminal 2，查看网络设备的状态信息
------------------------------------------

sar -n DEV 2（每2秒查看网络设备的状态信息）

::

    [tom@jlch_web_001 ~]$ sar -n DEV 2
    10:57:27 AM     IFACE   rxpck/s   txpck/s    rxkB/s    txkB/s   rxcmp/s   txcmp/s  rxmcst/s
    10:57:29 AM      eth0      0.00      0.00      0.00      0.00      0.00      0.00      0.00
    10:57:29 AM      eth1    659.50    280.00    268.49    162.34      0.00      0.00      0.00
    10:57:29 AM        lo      0.00      0.00      0.00      0.00      0.00      0.00      0.00

    10:57:29 AM     IFACE   rxpck/s   txpck/s    rxkB/s    txkB/s   rxcmp/s   txcmp/s  rxmcst/s
    10:57:31 AM      eth0      0.00      0.00      0.00      0.00      0.00      0.00      0.00
    10:57:31 AM      eth1    644.00    290.00    207.79    173.37      0.00      0.00      0.00
    10:57:31 AM        lo      0.00      0.00      0.00      0.00      0.00      0.00      0.00

    10:57:31 AM     IFACE   rxpck/s   txpck/s    rxkB/s    txkB/s   rxcmp/s   txcmp/s  rxmcst/s
    10:57:33 AM      eth0      0.00      0.00      0.00      0.00      0.00      0.00      0.00
    10:57:33 AM      eth1    831.50    361.00    198.42    172.36      0.00      0.00      0.00
    10:57:33 AM        lo      0.00      0.00      0.00      0.00      0.00      0.00      0.00

    10:57:33 AM     IFACE   rxpck/s   txpck/s    rxkB/s    txkB/s   rxcmp/s   txcmp/s  rxmcst/s
    10:57:35 AM      eth0      0.00      0.00      0.00      0.00      0.00      0.00      0.00
    10:57:35 AM      eth1   1096.00    489.50    133.77    178.13      0.00      0.00      0.00
    10:57:35 AM        lo      0.00      0.00      0.00      0.00      0.00      0.00      0.00

    10:57:35 AM     IFACE   rxpck/s   txpck/s    rxkB/s    txkB/s   rxcmp/s   txcmp/s  rxmcst/s
    10:57:37 AM      eth0      0.00      0.00      0.00      0.00      0.00      0.00      0.00
    10:57:37 AM      eth1    443.50    178.00    273.62    170.70      0.00      0.00      0.00
    10:57:37 AM        lo      0.00      0.00      0.00      0.00      0.00      0.00      0.00

结果分析
----------------------------------------------
最大值为 1300rxkB/s，转换一下。

1300kB/s=10400（*8）kb/s=10.15（10400/1024）Mbps

也就是 10.15M 的带宽。



